<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <title>Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ø¹Ø¶Ø§ÛŒ Code Mem</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg:#0d1b1e; --panel:#112d32; --accent:#a8ff60; --line:#88c999;
      --text:#d0f0c0; --danger:#ff6b6b; --muted:#88c999;
    }
    *{box-sizing:border-box}
    body{background:var(--bg);color:var(--text);font-family:"Segoe UI",Tahoma;direction:rtl;margin:0}
    header{background:#1a3c40;color:var(--accent);text-align:center;padding:20px;font-size:1.6rem;font-weight:800}
    .wrap{max-width:900px;margin:0 auto;padding:16px}
    .panel{background:var(--panel);border:1px solid var(--line);border-radius:12px;padding:16px;margin:16px 0}
    input,select,button,textarea{
      padding:10px;border-radius:10px;border:1px solid var(--line);
      background:rgba(136,201,153,0.08);color:var(--text);font-size:1rem
    }
    button{cursor:pointer}
    button.primary{background:rgba(168,255,96,0.15);border-color:var(--accent)}
    .row{display:flex;gap:8px;flex-wrap:wrap}
    table{width:100%;border-collapse:collapse;margin-top:12px}
    th,td{border:1px solid var(--line);padding:8px;text-align:center}
    th{background:#1a3c40;color:var(--accent)}
    .actions button{margin:2px}
    .error{color:var(--danger)}
    .muted{color:var(--muted);font-size:0.9rem}
    .grid2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    @media (max-width:800px){.grid2{grid-template-columns:1fr}}
    .section-title{color:var(--accent);font-weight:700;margin-bottom:8px}
    .badge{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border:1px dashed var(--line);border-radius:999px;background:rgba(136,201,153,0.08)}
  </style>
</head>
<body>
  <header>Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ø¹Ø¶Ø§ÛŒ Code Mem</header>
  <main class="wrap">
    <!-- Login -->
    <section class="panel" id="loginPanel">
      <div class="section-title">ğŸ”‘ ÙˆØ±ÙˆØ¯ Ø§Ø¯Ù…ÛŒÙ†</div>
      <div class="row">
        <input id="adminCode" type="text" placeholder="Ú©Ø¯ ÙˆØ±ÙˆØ¯ Ø§Ø¯Ù…ÛŒÙ†">
        <button class="primary" onclick="login()">ÙˆØ±ÙˆØ¯</button>
      </div>
      <p id="loginError" class="error"></p>
      <p class="muted">ÙÙ‚Ø· Ø¨Ø§ Ú©Ø¯ Ø§Ø®ØªØµØ§ØµÛŒ ÙˆØ§Ø±Ø¯ Ù…ÛŒâ€ŒØ´ÛŒ: <span class="badge">ADMIN663ADMINBARANAESFFXFJ</span></p>
    </section>

    <!-- Admin -->
    <section class="panel" id="adminPanel" style="display:none;">
      <div class="grid2">
        <div>
          <div class="section-title">â• Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¹Ø¶Ùˆ Ø¬Ø¯ÛŒØ¯</div>
          <div class="row">
            <input id="nameInput" type="text" placeholder="Ù†Ø§Ù… Ø¹Ø¶Ùˆ">
            <select id="rankInput">
              <option value="Recruit">Recruit</option>
              <option value="Commander">Commander</option>
              <option value="Owner">Owner</option>
            </select>
            <input id="pointsInput" type="number" placeholder="Ø§Ù…ØªÛŒØ§Ø² Ø§ÙˆÙ„ÛŒÙ‡" value="0">
            <button class="primary" onclick="addMember()">Ø«Ø¨Øª Ø¹Ø¶Ùˆ</button>
          </div>
          <p class="muted">Ù†Ø§Ù…â€ŒÙ‡Ø§ ÛŒÚ©ØªØ§ Ù†ÛŒØ³ØªÙ†Ø› Ø§Ú¯Ø± Ù…ÛŒâ€ŒØ®ÙˆØ§ÛŒ ÛŒÚ©ØªØ§ Ø¨Ø§Ø´Ù†ØŒ Ø®ÙˆØ¯Øª Ø±Ø¹Ø§ÛŒØª Ú©Ù† ÛŒØ§ Ø§Ø² Ø¬Ø³ØªØ¬Ùˆ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†.</p>
        </div>
        <div>
          <div class="section-title">ğŸ” Ø¬Ø³ØªØ¬Ùˆ Ùˆ Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§</div>
          <div class="row">
            <input id="searchInput" type="text" placeholder="Ø¬Ø³ØªØ¬Ùˆ Ø¨Ø± Ø§Ø³Ø§Ø³ Ù†Ø§Ù…...">
            <button onclick="renderMembers()">Ø§Ø¹Ù…Ø§Ù„ Ø¬Ø³ØªØ¬Ùˆ</button>
            <button onclick="resetSearch()">Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ø¬Ø³ØªØ¬Ùˆ</button>
          </div>
          <div class="row" style="margin-top:8px;">
            <button onclick="exportMembers()" class="primary">ğŸ“¤ Ø®Ø±ÙˆØ¬ÛŒ JSON</button>
            <button onclick="importMembersPrompt()">ğŸ“¥ ÙˆØ±ÙˆØ¯ Ø§Ø² JSON</button>
            <button onclick="clearAll()" style="border-color:#ff6b6b;color:#ff6b6b">ğŸ§¹ Ù¾Ø§Ú©â€ŒØ³Ø§Ø²ÛŒ Ú©Ø§Ù…Ù„</button>
          </div>
        </div>
      </div>

      <hr style="border-color:rgba(136,201,153,0.3);margin:14px 0">

      <div class="section-title">ğŸ‘¥ Ù„ÛŒØ³Øª Ø§Ø¹Ø¶Ø§</div>
      <table>
        <thead>
          <tr><th>Ù†Ø§Ù…</th><th>Ø±Ù†Ú©</th><th>Ø§Ù…ØªÛŒØ§Ø²</th><th>Ù…Ø¯ÛŒØ±ÛŒØª</th></tr>
        </thead>
        <tbody id="membersTable"></tbody>
      </table>
      <p class="muted">Ù†Ú©ØªÙ‡: Ø§Ø±ØªÙ‚Ø§ Ø±Ù†Ú© Ø¨Ù‡ ØªØ±ØªÛŒØ¨ Recruit â†’ Commander â†’ Owner Ø§Ù†Ø¬Ø§Ù… Ù…ÛŒâ€ŒØ´ÙˆØ¯.</p>
    </section>
  </main>

  <script>
    const ADMIN_CODE = "ADMIN663ADMINBARANAESFFXFJ";
    const STORAGE_KEY = "codeMemMembers";

    function login() {
      const code = document.getElementById("adminCode").value.trim();
      const err = document.getElementById("loginError");
      if (code === ADMIN_CODE) {
        document.getElementById("loginPanel").style.display = "none";
        document.getElementById("adminPanel").style.display = "block";
        err.textContent = "";
        renderMembers();
      } else {
        err.textContent = "Ú©Ø¯ Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª!";
      }
    }

    function loadMembers() {
      const raw = localStorage.getItem(STORAGE_KEY);
      return raw ? JSON.parse(raw) : [];
    }
    function saveMembers(list) {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(list));
    }

    function addMember() {
      const name = document.getElementById("nameInput").value.trim();
      const rank = document.getElementById("rankInput").value;
      const points = parseInt(document.getElementById("pointsInput").value) || 0;
      if (!name) return alert("Ù†Ø§Ù… Ø¹Ø¶Ùˆ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯");
      const members = loadMembers();
      members.push({ name, rank, points });
      saveMembers(members);
      document.getElementById("nameInput").value = "";
      document.getElementById("pointsInput").value = "0";
      renderMembers();
    }

    function renderMembers() {
      const tbody = document.getElementById("membersTable");
      const q = (document.getElementById("searchInput").value || "").trim();
      const members = loadMembers();
      const filtered = q ? members.filter(m => (m.name || "").includes(q)) : members;

      tbody.innerHTML = "";
      filtered.forEach((m, i) => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${m.name}</td>
          <td>${m.rank}</td>
          <td>${m.points}</td>
          <td class="actions">
            <button onclick="changeRank(${i})">Ø§Ø±ØªÙ‚Ø§ Ø±Ù†Ú©</button>
            <button onclick="addPoints(${i},10)">+10 Ø§Ù…ØªÛŒØ§Ø²</button>
            <button onclick="addPoints(${i},-5)">-5 Ø§Ù…ØªÛŒØ§Ø²</button>
            <button onclick="editMember(${i})">âœï¸ ÙˆÛŒØ±Ø§ÛŒØ´</button>
            <button onclick="deleteMember(${i})">âŒ Ø­Ø°Ù</button>
          </td>`;
        tbody.appendChild(row);
      });
    }

    function resetSearch() {
      document.getElementById("searchInput").value = "";
      renderMembers();
    }

    function changeRank(i) {
      const members = loadMembers();
      const ranks = ["Recruit", "Commander", "Owner"];
      const idx = ranks.indexOf(members[i].rank);
      if (idx < ranks.length - 1) {
        members[i].rank = ranks[idx + 1];
        saveMembers(members);
        renderMembers();
      } else {
        alert("Ø§ÛŒÙ† Ø¹Ø¶Ùˆ Ø¯Ø± Ø¨Ø§Ù„Ø§ØªØ±ÛŒÙ† Ø±Ù†Ú© Ø§Ø³Øª.");
      }
    }

    function addPoints(i, delta) {
      const members = loadMembers();
      members[i].points = (members[i].points || 0) + delta;
      saveMembers(members);
      renderMembers();
    }

    function editMember(i) {
      const members = loadMembers();
      const m = members[i];
      const newName = prompt("Ù†Ø§Ù… Ø¬Ø¯ÛŒØ¯:", m.name);
      if (newName === null) return;
      const newRank = prompt("Ø±Ù†Ú© Ø¬Ø¯ÛŒØ¯ (Recruit/Commander/Owner):", m.rank);
      if (newRank === null) return;
      const newPointsStr = prompt("Ø§Ù…ØªÛŒØ§Ø² Ø¬Ø¯ÛŒØ¯:", m.points);
      if (newPointsStr === null) return;
      const newPoints = parseInt(newPointsStr);
      if (!newName.trim() || !["Recruit","Commander","Owner"].includes(newRank)) {
        alert("ÙˆØ±ÙˆØ¯ÛŒ Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª.");
        return;
      }
      m.name = newName.trim();
      m.rank = newRank;
      m.points = isNaN(newPoints) ? m.points : newPoints;
      saveMembers(members);
      renderMembers();
    }

    function deleteMember(i) {
      const members = loadMembers();
      if (!confirm(`Ø­Ø°Ù ${members[i].name}ØŸ`)) return;
      members.splice(i, 1);
      saveMembers(members);
      renderMembers();
    }

    function exportMembers() {
      const data = JSON.stringify(loadMembers(), null, 2);
      const blob = new Blob([data], { type: "application/json" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url; a.download = "code_mem_members.json";
      document.body.appendChild(a); a.click();
      document.body.removeChild(a); URL.revokeObjectURL(url);
    }

    function importMembersPrompt() {
      const input = document.createElement("input");
      input.type = "file"; input.accept = "application/json";
      input.onchange = () => {
        const file = input.files[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = () => {
          try {
            const list = JSON.parse(reader.result);
            if (!Array.isArray(list)) throw new Error("ÙØ±Ù…Øª Ù†Ø§Ù…Ø¹ØªØ¨Ø±");
            saveMembers(list);
            renderMembers();
            alert("ÙˆØ±ÙˆØ¯ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯.");
          } catch (e) {
            alert("Ø®Ø·Ø§ Ø¯Ø± Ø®ÙˆØ§Ù†Ø¯Ù† ÙØ§ÛŒÙ„ JSON.");
          }
        };
        reader.readAsText(file);
      };
      input.click();
    }

    function clearAll() {
      if (!confirm("Ù¾Ø§Ú©â€ŒØ³Ø§Ø²ÛŒ Ú©Ø§Ù…Ù„ Ø§Ø¹Ø¶Ø§ØŸ Ø§ÛŒÙ† Ú©Ø§Ø± Ù‚Ø§Ø¨Ù„ Ø¨Ø§Ø²Ú¯Ø´Øª Ù†ÛŒØ³Øª.")) return;
      localStorage.removeItem(STORAGE_KEY);
      renderMembers();
    }
  </script>
</body>
  </html>
